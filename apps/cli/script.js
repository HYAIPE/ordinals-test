"use strict";(()=>{var te=Object.create;var Mr=Object.defineProperty;var ee=Object.getOwnPropertyDescriptor;var oe=Object.getOwnPropertyNames;var ne=Object.getPrototypeOf,ae=Object.prototype.hasOwnProperty;var Er=(r,t)=>()=>(t||r((t={exports:{}}).exports,t),t.exports);var ie=(r,t,e,n)=>{if(t&&typeof t=="object"||typeof t=="function")for(let u of oe(t))!ae.call(r,u)&&u!==e&&Mr(r,u,{get:()=>t[u],enumerable:!(n=ee(t,u))||n.enumerable});return r};var ue=(r,t,e)=>(e=r!=null?te(ne(r)):{},ie(t||!r||!r.__esModule?Mr(e,"default",{value:r,enumerable:!0}):e,r));var Nr=Er((Vo,Fr)=>{"use strict";var se="bold|bolder|lighter|[1-9]00",ce="italic|oblique",me="small-caps",le="ultra-condensed|extra-condensed|condensed|semi-condensed|semi-expanded|expanded|extra-expanded|ultra-expanded",de="px|pt|pc|in|cm|mm|%|em|ex|ch|rem|q",qr=`'([^']+)'|"([^"]+)"|[\\w\\s-]+`,he=new RegExp(`(${se}) +`,"i"),ye=new RegExp(`(${ce}) +`,"i"),xe=new RegExp(`(${me}) +`,"i"),ve=new RegExp(`(${le}) +`,"i"),ge=new RegExp(`([\\d\\.]+)(${de}) *((?:${qr})( *, *(?:${qr}))*)`),hr={},_e=16;Fr.exports=r=>{if(hr[r])return hr[r];let t=ge.exec(r);if(!t)return;let e={weight:"normal",style:"normal",stretch:"normal",variant:"normal",size:parseFloat(t[1]),unit:t[2],family:t[3].replace(/["']/g,"").replace(/ *, */g,",")},n,u,c,s,d=r.substring(0,t.index);switch((n=he.exec(d))&&(e.weight=n[1]),(u=ye.exec(d))&&(e.style=u[1]),(c=xe.exec(d))&&(e.variant=c[1]),(s=ve.exec(d))&&(e.stretch=s[1]),e.unit){case"pt":e.size/=.75;break;case"pc":e.size*=16;break;case"in":e.size*=96;break;case"cm":e.size*=96/2.54;break;case"mm":e.size*=96/25.4;break;case"%":break;case"em":case"rem":e.size*=_e/.75;break;case"q":e.size*=96/25.4/4;break}return hr[r]=e}});var Dr=Er($=>{var we=Nr();$.parseFont=we;$.createCanvas=function(r,t){return Object.assign(document.createElement("canvas"),{width:r,height:t})};$.createImageData=function(r,t,e){switch(arguments.length){case 0:return new ImageData;case 1:return new ImageData(r);case 2:return new ImageData(r,t);default:return new ImageData(r,t,e)}};$.loadImage=function(r,t){return new Promise(function(e,n){let u=Object.assign(document.createElement("img"),t);function c(){u.onload=null,u.onerror=null}u.onload=function(){c(),e(u)},u.onerror=function(){c(),n(new Error('Failed to load the image "'+r+'"'))},u.src=r})}});function fe(r,t,e,n,u,c,s){let d=n*s+r*(1-s),l=u*s+t*(1-s),y=c*s+e*(1-s);return[d,l,y]}function pe(r,t){async function e(n){if(r===0)return;let{width:u,height:c}=n.canvas,s=n.getImageData(0,0,u,c),d=n.createImageData(u,c);for(let l=0;l<u;l++)for(let y=0;y<c;y++){let p=(l+y*u)*4,a=s.data[p+0]/255,i=s.data[p+1]/255,T=s.data[p+2]/255,I=s.data[p+3]/255;if(I===0)continue;let b,M,q,B=0;I>0&&(a/=I,i/=I,T/=I),b=t[0]*a,b+=t[1]*i,b+=t[2]*T,b+=t[3]*I,b+=t[4],M=t[5]*a,M+=t[6]*i,M+=t[7]*T,M+=t[8]*I,M+=t[9],q=t[10]*a,q+=t[11]*i,q+=t[12]*T,q+=t[13]*I,q+=t[14],B=t[15]*a,B+=t[16]*i,B+=t[17]*T,B+=t[18]*I,B+=t[19],[b,M,q]=fe(a,i,T,b,M,q,r),b*=B,M*=B,q*=B,d.data[p+0]=er(b*255),d.data[p+1]=er(M*255),d.data[p+2]=er(q*255),d.data[p+3]=er(I*255)}n.putImageData(d,0,0)}return e}function Pr(){let r=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],t=1;function e(){return r}function n(p){r=[...p]}function u(p){t=p}function c(p,a,i){return p[0]=a[0]*i[0]+a[1]*i[5]+a[2]*i[10]+a[3]*i[15],p[1]=a[0]*i[1]+a[1]*i[6]+a[2]*i[11]+a[3]*i[16],p[2]=a[0]*i[2]+a[1]*i[7]+a[2]*i[12]+a[3]*i[17],p[3]=a[0]*i[3]+a[1]*i[8]+a[2]*i[13]+a[3]*i[18],p[4]=a[0]*i[4]+a[1]*i[9]+a[2]*i[14]+a[3]*i[19]+a[4],p[5]=a[5]*i[0]+a[6]*i[5]+a[7]*i[10]+a[8]*i[15],p[6]=a[5]*i[1]+a[6]*i[6]+a[7]*i[11]+a[8]*i[16],p[7]=a[5]*i[2]+a[6]*i[7]+a[7]*i[12]+a[8]*i[17],p[8]=a[5]*i[3]+a[6]*i[8]+a[7]*i[13]+a[8]*i[18],p[9]=a[5]*i[4]+a[6]*i[9]+a[7]*i[14]+a[8]*i[19]+a[9],p[10]=a[10]*i[0]+a[11]*i[5]+a[12]*i[10]+a[13]*i[15],p[11]=a[10]*i[1]+a[11]*i[6]+a[12]*i[11]+a[13]*i[16],p[12]=a[10]*i[2]+a[11]*i[7]+a[12]*i[12]+a[13]*i[17],p[13]=a[10]*i[3]+a[11]*i[8]+a[12]*i[13]+a[13]*i[18],p[14]=a[10]*i[4]+a[11]*i[9]+a[12]*i[14]+a[13]*i[19]+a[14],p[15]=a[15]*i[0]+a[16]*i[5]+a[17]*i[10]+a[18]*i[15],p[16]=a[15]*i[1]+a[16]*i[6]+a[17]*i[11]+a[18]*i[16],p[17]=a[15]*i[2]+a[16]*i[7]+a[17]*i[12]+a[18]*i[17],p[18]=a[15]*i[3]+a[16]*i[8]+a[17]*i[13]+a[18]*i[18],p[19]=a[15]*i[4]+a[16]*i[9]+a[17]*i[14]+a[18]*i[19]+a[19],p}function s(p){let a=[...p];return a[4]/=255,a[9]/=255,a[14]/=255,a[19]/=255,a}function d(p,a=!1){let i=p;a&&(c(i,r,p),i=s(i)),n(i)}return[()=>pe(t,r),{getMatrix:e,setMatrix:n,setAlpha:u,multiply:c,colorMatrix:s,loadMatrix:d}]}function v(r,t,e){let[n,u,c]=t,[s,d,l]=e,y=[n*s,u*s,c*s,0,0,n*d,u*d,c*d,0,0,n*l,u*l,c*l,0,0,0,0,0,1,0];r.loadMatrix(y)}function er(r){return r<0?0:r>255?255:Math.round(r)}function g(r){let t=parseInt(r.substr(1,2),16)/255,e=parseInt(r.substr(3,2),16)/255,n=parseInt(r.substr(5,2),16)/255;return[t,e,n]}var dr=new Map;async function Rr(r,t){if(dr.has(r))return dr.get(r);let e=await t(r);return dr.set(r,e),e}async function zr(r,t){if(typeof window<"u"&&typeof document<"u"){let n=document.createElement("canvas");return n.width=r,n.height=t,n}let e=await Promise.resolve().then(()=>ue(Dr(),1));return new e.Canvas(r,t)}function h(r,t){return async e=>{let n=await Rr(r,t);e.drawImage(n,0,0)}}function J(...r){return async t=>{for(let e of r)await e(t)}}async function A(...r){return async t=>{let e=await zr(t.canvas.width,t.canvas.height),n=e.getContext("2d");n.clearRect(0,0,e.width,e.height),await J(...r)(n),t.drawImage(e,0,0)}}async function jr(r,t){let e=r.getContext("2d");e.clearRect(0,0,r.width,r.height);for(let n of[...t].sort((u,c)=>u.zIndex-c.zIndex))await n.draw(e)}function P(r){return r!=null&&typeof r=="object"&&r["@@functional/placeholder"]===!0}function f(r){return function t(e){return arguments.length===0||P(e)?t:r.apply(this,arguments)}}function o(r){return function t(e,n){switch(arguments.length){case 0:return t;case 1:return P(e)?t:f(function(u){return r(e,u)});default:return P(e)&&P(n)?t:P(e)?f(function(u){return r(u,n)}):P(n)?f(function(u){return r(e,u)}):r(e,n)}}}var k=Array.isArray||function(t){return t!=null&&t.length>=0&&Object.prototype.toString.call(t)==="[object Array]"};var U=Number.isInteger||function(t){return t<<0===t};var Q=function(t){return(t<10?"0":"")+t},Mp=typeof Date.prototype.toISOString=="function"?function(t){return t.toISOString()}:function(t){return t.getUTCFullYear()+"-"+Q(t.getUTCMonth()+1)+"-"+Q(t.getUTCDate())+"T"+Q(t.getUTCHours())+":"+Q(t.getUTCMinutes())+":"+Q(t.getUTCSeconds())+"."+(t.getUTCMilliseconds()/1e3).toFixed(3).slice(2,5)+"Z"};var Z1=typeof String.prototype.trim=="function";var Bo=o(function(t,e){for(var n=0,u=Math.min(t.length,e.length),c={};n<u;)c[t[n]]=e[n],n+=1;return c}),Lr=Bo;function S(r,t){let e=Object.keys(r),n=Object.values(r);return Oo(e,n,t)}function W(r,t,e){let n=Lo(Object.values(e),r,t);return Lr(Object.keys(e),n)}function Lo(r,t,e){let n=r.reduce((l,y)=>l+y,0),u=r.map(l=>l/n),c=e-t,s=u.map(l=>Math.round(l*c)),d=s.reduce((l,y)=>l+y,0);if(d!==c){let l=c-d,y=s.indexOf(s.reduce((p,a)=>Math.max(p,a),0));s[y]+=l}return s}function Oo(r,t,e=n=>Math.random()*n){if(r.length!==t.length)throw new RangeError("Chance: Length of array and weights must match");let n=0,u;for(let p=0;p<t.length;++p){if(u=t[p],isNaN(u))throw new RangeError("Chance: All weights must be numbers");u>0&&(n+=u)}if(n===0)throw new RangeError("Chance: No valid entries in array weights");let c=e(n),s=0,d=-1,l=0;for(let p=0;p<t.length;++p){if(u=t[p],s+=u,u>0){if(c<=s){l=p;break}d=p}p===t.length-1&&(l=d)}var y=r[l];return y}var w=[0,1,0],ft=g("#906B4A"),pt=g("#261C13"),st=g("#FEC8EA"),ct=g("#C63D72"),mt=g("#FFCBBF"),lt=g("#FF6C62"),dt=g("#F0F4FB"),ht=g("#C86C93"),yt=g("#B1FF8B"),xt=g("#20BA90"),vt=g("#3D3F49"),gt=g("#161D3D"),_t=g("#ED8567"),wt=g("#C0421D"),It=g("#672C32"),At=g("#431419"),bt=g("#513872"),Ct=g("#1E004C"),Wt=g("#D2522B"),kt=g("#B73811");var V=[{color:"Pink",filter:[r=>v(r,w,st)]},{color:"Peach",filter:[r=>v(r,w,mt)]},{color:"Brown",filter:[r=>v(r,w,ft)]},{color:"White",filter:[r=>v(r,w,dt)]},{color:"Lime",filter:[r=>v(r,w,yt)]},{color:"Black",filter:[r=>v(r,w,vt)]},{color:"Red",filter:[r=>v(r,w,_t)]}],Or=[{color:"Pink",filter:[r=>v(r,w,ct)]},{color:"Peach",filter:[r=>v(r,w,lt)]},{color:"Brown",filter:[r=>v(r,w,pt)]},{color:"White",filter:[r=>v(r,w,ht)]},{color:"Lime",filter:[r=>v(r,w,xt)]},{color:"Black",filter:[r=>v(r,w,gt)]},{color:"Red",filter:[r=>v(r,w,wt)]}],St=[{color:"Red",filter:[r=>v(r,w,It)]},{color:"Purple",filter:[r=>v(r,w,bt)]},{color:"Orange",filter:[r=>v(r,w,Wt)]}],To=[{color:"Red",filter:[r=>v(r,w,At)]},{color:"Purple",filter:[r=>v(r,w,Ct)]},{color:"Orange",filter:[r=>v(r,w,kt)]}];function mr(r){return["Diamond","Gold"].includes(r)}function Lt({color:r},t){return{draw:h(`${r}.webp`,t),zIndex:-1/0}}function E(r,t){let e=[],n=r.find(u=>u.color===t)?.filter;return n&&e.push(...n.map(u=>{let[c,s]=Pr();return u(s),c()})),e}async function Mo({zIndex:r,baseColor:t,secondaryColor:e,baseColorBasePath:n,secondaryColorBasePath:u},c){let s;function d(p,a,i,T){let I=["Diamond","Gold"].includes(a),b=[h(`${i}/${I?a:T}.webp`,c)];return I||b.push(...E(p,a)),b}let l=d(V,t,n,"BaseColor"),y=e?d(V,e,u,"SplitColor"):[];return s=J(await A(...l),await A(...y)),{draw:s,zIndex:r}}function Ot({color:r,splitColor:t},e){return Mo({zIndex:-1e5,baseColor:r,secondaryColor:t,baseColorBasePath:"BaseColor",secondaryColorBasePath:"SplitColor"},e)}async function Tt({color:r,splitColor:t,tailType:e},n){let u=[];if(r=t??r,mr(r))u.push(h(`Tails/${e}-Colors/${r}.webp`,n));else{let c=E(V,r),s=E(Or,r);u.push(await A(h(`Tails/${e}-Colors/${e}-Base.webp`,n),...c),await A(h(`Tails/${e}-Colors/${e}-Accent.webp`,n),...s))}return u.push(h(`Tails/${e}.webp`,n)),[{draw:await A(...u),zIndex:-1e3}]}function Mt(r){return{draw:h("Base/Base.webp",r),zIndex:1700}}async function Et({color:r,faceType:t,frillType:e,mouthType:n,headType:u,specialType:c,splitColor:s,mustache:d},l){return c==="None"?[...await Bt({color:r,frillType:e,splitColor:s},l),...await Eo({mouthType:n,mustache:d},l),Po({faceType:t},l),Ro({color:r,splitColor:s,headType:u},l)]:c==="TV Head"?[{draw:h(`Special/${c}.webp`,l),zIndex:1e9}]:[{draw:h(`Special/${c}.webp`,l),zIndex:1e9},...await Bt({color:r,frillType:e,splitColor:s},l)]}async function Bt({color:r,splitColor:t,frillType:e},n){let u=[];if(mr(r))u.push(h(`Ears/${e}-Colors/Base/${r}.webp`,n));else{let c=E(V,r),s=E(Or,r);u.push(await A(h(`Ears/${e}-Colors/${e}-Base.webp`,n),...c),await A(h(`Ears/${e}-Colors/${e}-Accent.webp`,n),...s))}if(t)if(mr(t))u.push(h(`Ears/${e}-Colors/Base/${t}.webp`,n));else{let c=E(V,t),s=E(Or,t);u.push(await A(h(`Ears/${e}-Colors/${e}-Base-Split.webp`,n),...c),await A(h(`Ears/${e}-Colors/${e}-Accent-Split.webp`,n),...s))}return u.push(h(`Ears/${e}.webp`,n)),[{draw:await A(...u),zIndex:1500}]}async function Eo({mouthType:r,mustache:t},e){return[{draw:h(`Mouths/${r}.webp`,e),zIndex:9999990},...t?[{draw:h("Mouths/Moustache.webp",e),zIndex:10000010}]:[]]}function Po({faceType:r},t){return{draw:h(`Eyes/${r}.webp`,t),zIndex:1e7}}function Ro({headType:r,color:t,splitColor:e},n){let u;return["Side","Tuft"].includes(r)?u=J(h(`Head/${r}-Color/${e||t}.webp`,n),h(`Head/${r}.webp`,n)):u=h(`Head/${r}.webp`,n),{draw:u,zIndex:10000005}}async function Pt({armType:r,color:t,splitColor:e},n){let u=[];if(mr(t))u.push(h(`Arms/${r}-Colors/Base/${t}.webp`,n));else if(u.push(await A(h(`Arms/${r}-Colors/${r}-Base.webp`,n),...E(V,t))),e){let c=E(V,e);u.push(await A(h(`Arms/${r}-Colors/${r}-Split.webp`,n),...c))}return[{draw:J(await A(...u),h(`Arms/${r}.webp`,n)),zIndex:1000105}]}async function Rt({accessoryType:r,color:t},e){let n=[];return r==="Flamingo"?(n.push({draw:h(`Accessories/${r}B.webp`,e),zIndex:5e4}),n.push({draw:h(`Accessories/${r}T.webp`,e),zIndex:1000500})):r==="Hoodie"?(n.push({draw:await A(h("Accessories/HoodieBase.webp",e),...E(St,t)),zIndex:1e6}),n.push({draw:await A(h("Accessories/HoodieLine.webp",e)),zIndex:1000030}),n.push({draw:await A(h("Accessories/SleevesColor.webp",e),...E(St,t)),zIndex:1000500}),n.push({draw:await A(h("Accessories/HoodieAccent.webp",e),...E(To,t)),zIndex:1000020}),n.push({draw:await A(h("Accessories/SleevesLine.webp",e)),zIndex:1000530})):r!=="None"&&n.push({draw:h(`Accessories/${r}.webp`,e),zIndex:1000500}),n}var qt=W(0,255,{Blue:40,Gold:7,Lime:3,Pink:20,Salmon:20,Turquoise:20,White:1}),Ft=W(0,255,{Normal:6,Curled:3,Wiggles:1,Short:.5}),Tr=W(0,255,{Pink:30.25,Peach:24,Brown:16,White:20,Gold:.5,Diamond:.25,Lime:1,Black:10}),Nt=W(0,255,{Split:2,"Not Split":48}),Dt=W(0,255,{None:98.5,"Skull Face":.5,"TV Head":.5,"Giant Eye":.5}),zt=W(0,255,{Claws:8,Paws:2}),jt=W(0,255,{Short:2,Wide:3,Thin:4,Wiggles:1,Puffy:1,"Teenie Tiny":1}),Ht=W(0,255,{None:40,"Bow Tie":16,Heart:12,"Neck Tie":5,"Rainbow Cape":3,Flamingo:3,Floaties:8,Hoodie:2}),Ut=W(0,255,{Red:10,Orange:50,Purple:10}),Xt=W(0,255,{Anger:10,"Clout Goggles":3,Derp:7,Lash:25,Oval:30,Troll:4,Visor:6,Bored:9,Disapproval:4}),Vt=W(0,255,{Bleh:11,Blunt:2,"Happy mouth":17,owo:14,Plain:10,Smile:19,Smirk:18,"Smol frown":7,Fangs:4}),Gt=W(0,255,{Mustache:3,"Clean Shaven":97}),Kt=W(0,255,{Bald:40,Tuft:22,Side:14,"Cowboy Hat":5,Crown:1,Halo:2,Octopus:1.5,"Party Hat":3,"Spin Beanie":2.5,Beanie:5.5,Birdie:3.5});function Fo(r){let t="";for(let e=0;e<r.length;e++){let n=r[e].toString(16);n=n.length===1?"0"+n:n,t+=n}return t}function No(r){let t=r,e=B=>{if(B!=255)throw new Error(`Expected a range of 255 but got ${B}`);let lr=t[0];return t=t.slice(1),lr},n=S(qt,e),u=S(Tr,e),c=S(Nt,e),s;if(c==="Split"){let B={...Tr};delete B[u];let lr=W(0,255,B);s=S(lr,e)}else t=t.slice(1);let d=S(Ht,e),l=S(Ut,e),y=S(Ft,e),p=S(zt,e),a=S(jt,e),i=S(Xt,e),T=S(Vt,e),I=S(Gt,e),b=S(Kt,e),M=S(Dt,e);return["Cloud Goggles","Troll","Visor"].includes(i)&&(I="Clean Shaven"),{metadata:{seed:Fo(r),attributes:[{trait_type:"Background Color",value:n},{trait_type:"Base Color",value:u},...c==="Split"?[{trait_type:"Secondary Color",value:s}]:[],...M!=="None"?[{trait_type:"Special Feature",value:M}]:[],{trait_type:"Accessory",value:d},...d==="Hoodie"?[{trait_type:"Accessory Color",value:l}]:[],{trait_type:"Tail",value:y},{trait_type:"Arm",value:p},{trait_type:"Frills",value:a},{trait_type:"Face",value:i},{trait_type:"Mouth",value:T},{trait_type:"Facial Hair",value:I},{trait_type:"Head",value:b}]},arm:p,special:M,accessory:d,accessoryColor:l,backgroundColor:n,baseColor:u,split:c,secondaryColor:s,tail:y,face:i,frills:a,mouth:T,head:b,mustache:I}}async function $t(r,t){let{metadata:e,arm:n,special:u,accessory:c,accessoryColor:s,backgroundColor:d,baseColor:l,secondaryColor:y,tail:p,face:a,frills:i,mouth:T,head:I,mustache:b}=No(r);return{metadata:e,layers:[Lt({color:d},t),await Ot({color:l,splitColor:y},t),...await Rt({accessoryType:c,color:s},t),...await Pt({armType:n,color:l,splitColor:y},t),...await Et({frillType:i,faceType:a,mouthType:T,headType:I,specialType:u,color:l,splitColor:y,mustache:b==="Mustache"},t),Mt(t),...await Tt({color:l,splitColor:y,tailType:p},t)]}}var Jt={};var tr=document.querySelector("canvas#main");function Do(r){return`/content/${Jt[r]??r}`}var Yt=null;async function zo(r){let{layers:t,metadata:e}=await $t(r,c=>{let s=document.createElement("img");return s.src=Do(c),s.crossOrigin="anonymous",new Promise(d=>{s.onload=()=>d(s)})});Yt=e;let n=document.createElement("canvas");n.width=569,n.height=569,await jr(n,t),tr.getContext("2d").drawImage(n,0,0)}function Zt(r){let t=new Uint8Array(r);for(let e=0;e<r;e++)t[e]=Math.floor(Math.random()*256);return t}async function jo(){let r;if(globalThis.window.genesis)try{let e=await fetch("/blockhash");if(e.status!==200)return Zt(32);r=await e.text()}catch{return null}else try{r=await(await fetch(`/blockhash/${globalThis.window.revealedAt}`)).text()}catch{return null}return await crypto.subtle.digest("SHA-256",new TextEncoder().encode(r+globalThis.window.tokenId))}async function Qt(){let r=await jo(),t,e=!1;if(r){let n=new Uint8Array(r);t=new Uint8Array(n.slice(0,32)),e=!0}else t=Zt(32);await zo(t),e||setTimeout(Qt,1e3)}Qt();function re(){var r=Math.min(window.innerWidth/569,window.innerHeight/569);tr.style.width=569*r+"px",tr.style.height=569*r+"px"}window.addEventListener("resize",re,!1);re();tr.addEventListener("contextmenu",r=>{r.preventDefault();let t=tr.toDataURL("image/png"),e=document.createElement("a");e.href=t,e.download=`${globalThis.window.tokenId}.png`,e.click()});window.addEventListener("keydown",r=>{if(r.key==="m"){r.preventDefault();let t=JSON.stringify({tokenId:globalThis.window.tokenId,...Yt},null,2),e=document.createElement("a");e.href="data:text/json;charset=utf-8,"+encodeURIComponent(t),e.download=`${globalThis.window.tokenId}.json`,e.click()}});})();
